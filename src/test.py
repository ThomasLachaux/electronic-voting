import utils.elgamal
import utils.password
import utils.math
from utils.constants import p, g

password = utils.password.generate_password()
pkdf = utils.password.generate_pkdf2(password, "0dc34485-1b2d-486b-8383-742ba09cf653")

pubkey =  utils.math.exponentiation(g, pkdf, p)

r, s = utils.elgamal.sign(pkdf, 3)

print(utils.elgamal.verify_signature(3, pubkey, r, s))


# password = utils.password.generate_password()

# s = utils.password.generate_pkdf2(password, "certification")
# pubkey =  utils.math.exponentiation(g, s, p)

# print((s, pubkey))

# pubkeys = (5635487785500973704853551902940640072262640589305904191832688302469059517938035246629701757139767503216478964207647903662466727479524986852869996679011381443297226236863267648965814741252943434812120564231679646866247353605565660211294781463242980410289765632092089521892549233547441046990971757019861039065381277992443438077529134236346249229091414846727732036535957692535026026370695849610720927389354030623755043871870872306113416403771423503257456428350047270396040363722519486824621771255201790205678478232951993391594659659326121686026557490960794159831693727149265320429189312266169978718125601568374469406948, 13256066063421609376890414455876721976379400608181774213421188250506397885362519402464706468398441942829454984520268998800211745892905712975241361464675419833420009887141730301548005592169946981832486972552433440204615475853910853760568970617771344781426477059459860222445115285388155556107933625746310096068049374797237674459449040416556625269650299856730126160378639397931285188301526419757005661557593897638392692017118474910474754773929706861634059416467226043923185541129648038062197022695970744621417058524417026129921852939153216527268558535607789602926984390965172803460136151777024092702137951633734324506925, 21436775994489047032315738659604576304333651767988323277225140295405083423133334176977084318916864769678056685355199868271420489951694078249164715499973327981309227636620055275949031602081225665895013533352838034203165856840433542664579865176852870240485069881603551077408575338999435544317995594253565476225722258860079672125425393418607116447510008500186019063329552927170382612678444550270242327405088323981723066444455055441618131530659419544269403668681053429665116641587921190321488386546343682429515977086349599044513828213906781806456670612271648699471928009076548040293486932515407723345376888045226025233441)

# common_pubkey = sum(pubkeys) % p

# c1, c2 = utils.elgamal.encrypt(1, common_pubkey)

# common_privkey = 0
# for password in ('ShcUUVpecKcmejD', 'zXqkv6Gr3B1F7Pd', 'abeWUqFKwQJUepN'):
  
#   privkey = utils.password.generate_pkdf2(password, 'dada15f5-9d9d-4bf9-bcba-49505873406a')
#   common_privkey += privkey % p

# common_pubkey = utils.math.exponentiation(g, common_privkey, p)
# print(common_pubkey)


# c1, c2 = utils.elgamal.encrypt(1, common_pubkey)
# print(utils.elgamal.decrypt(c1, c2, common_privkey))